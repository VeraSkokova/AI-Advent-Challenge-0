# üìâ –î–µ–Ω—å 9. –°–∂–∞—Ç–∏–µ –î–∏–∞–ª–æ–≥–∞ (Context Compression)

**–¶–µ–ª—å:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–∂–∞—Ç–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

**–ú–µ—Ö–∞–Ω–∏–∫–∞ ("Sliding Window Summary"):**
1.  **–¢—Ä–∏–≥–≥–µ—Ä:** –°–∂–∞—Ç–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –∏—Å—Ç–æ—Ä–∏—è –¥–æ—Å—Ç–∏–≥–∞–µ—Ç **10 —Å–æ–æ–±—â–µ–Ω–∏–π** (`size >= 10`).
2.  **–ê–ª–≥–æ—Ä–∏—Ç–º:**
    *   –°–æ—Ö—Ä–∞–Ω—è–µ–º `System Prompt` (–ª–∏—á–Ω–æ—Å—Ç—å).
    *   –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 —Å–æ–æ–±—â–µ–Ω–∏—è (–∞–∫—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç).
    *   –í—Å—ë, —á—Ç–æ –º–µ–∂–¥—É –Ω–∏–º–∏, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∞–≥–µ–Ω—Ç—É-—Å—É–º–º–∞—Ä–∏–∑–∞—Ç–æ—Ä—É (`Summarizer Persona` –Ω–∞ –±–∞–∑–µ Lite –º–æ–¥–µ–ª–∏).
    *   –ó–∞–º–µ–Ω—è–µ–º —Å—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –æ–¥–Ω–æ —Å–∏—Å—Ç–µ–º–Ω–æ–µ: `PREVIOUS CONTEXT SUMMARY: ...`.

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞

### 1. –î–æ —Å–∂–∞—Ç–∏—è (10 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ø–∞–º—è—Ç–∏)
*   **–ó–∞–ø—Ä–æ—Å:** "–ß—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫?"
*   **–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è —è–∑—ã–∫–∞ Kotlin.
*   **–ú–µ—Ç—Ä–∏–∫–∏:**
    *   `Input Tokens`: **~800** (–Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç)
    *   `Cost`: –í—ã—Å–æ–∫–∞—è –∏–∑-–∑–∞ –¥–ª–∏–Ω–Ω–æ–≥–æ "—Ö–≤–æ—Å—Ç–∞" –∏—Å—Ç–æ—Ä–∏–∏.

### 2. –ü—Ä–æ—Ü–µ—Å—Å —Å–∂–∞—Ç–∏—è
üßπ Compressing conversation history...
‚úÖ History compressed: 10 -> 4 messages.
üìâ Summary: –ö–æ—Ç–ª–∏–Ω ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Java, —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–∏...

text
*–ò—Å—Ç–æ—Ä–∏—è —Å–æ–∫—Ä–∞—Ç–∏–ª–∞—Å—å —Å 10 –¥–æ 4 —Å–æ–æ–±—â–µ–Ω–∏–π (System + Summary + User + Assistant).*

### 3. –ü–æ—Å–ª–µ —Å–∂–∞—Ç–∏—è (4 —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ø–∞–º—è—Ç–∏)
*   **–ó–∞–ø—Ä–æ—Å:** "–ù–∞–ø–æ–º–Ω–∏, –æ –∫–∞–∫–æ–º —è–∑—ã–∫–µ –º—ã –≥–æ–≤–æ—Ä–∏–ª–∏"
*   **–û—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏:** "–ú—ã –≥–æ–≤–æ—Ä–∏–ª–∏ –æ —è–∑—ã–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –ö–æ—Ç–ª–∏–Ω..." (–ö–æ–Ω—Ç–µ–∫—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω!)
*   **–ú–µ—Ç—Ä–∏–∫–∏:**
    *   `Input Tokens`: **506** (–≤–º–µ—Å—Ç–æ ~900+, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –±—ã –±–µ–∑ —Å–∂–∞—Ç–∏—è)
    *   `Cost`: 0.2220 ‚ÇΩ
    *   **–≠–∫–æ–Ω–æ–º–∏—è:** **~40-50%** —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–º –ø–æ—Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—Ä–æ—Å–µ.

---

## üí° –í—ã–≤–æ–¥—ã

1.  **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** –†–µ–≥—É–ª—è—Ä–Ω–æ–µ —Å–∂–∞—Ç–∏–µ (–∫–∞–∂–¥—ã–µ 10 —Å–æ–æ–±—â–µ–Ω–∏–π) —É–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ —Ä–∞–∑—É–º–Ω—ã—Ö –ø—Ä–µ–¥–µ–ª–∞—Ö, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –ª–∏–Ω–µ–π–Ω—ã–π —Ä–æ—Å—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–∏–∞–ª–æ–≥–∞.
2.  **–ö–∞—á–µ—Å—Ç–≤–æ:** RAG-–ø–æ–¥—Ö–æ–¥ (–≤–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å–∞–º–º–∞—Ä–∏ –≤ —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç) –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ "–ø–æ–º–Ω–∏—Ç—å" –∫–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç—ã, –¥–∞–∂–µ –µ—Å–ª–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω—ã.
3.  **–ê–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–µ—à–µ–≤–æ–π –º–æ–¥–µ–ª–∏ (Lite) –¥–ª—è —Å–ª—É–∂–µ–±–Ω–æ–π –∑–∞–¥–∞—á–∏ —Å–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω—ã–º.